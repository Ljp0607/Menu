## 问题分析

1. **服务器状态**：本地服务器运行正常，通过 `localhost:3000` 可以访问
2. **域名解析**：域名 `lijunpeng.top` 已正确解析到公网 IP `112.120.103.233`
3. **访问错误**：通过域名访问时显示 "502 错误的网关"

## 解决方案

### 步骤1：设置路由器端口转发
1. 登录路由器管理界面（通常访问 `192.168.41.1`）
2. 找到 "端口转发" 或 "虚拟服务器" 设置
3. 添加转发规则：
   - 外部端口：3000
   - 内部 IP 地址：192.168.41.139（您电脑的内网 IP）
   - 内部端口：3000
   - 协议：TCP

### 步骤2：开放 Windows 防火墙
1. 打开 "控制面板" → "系统和安全" → "Windows Defender 防火墙"
2. 点击 "高级设置" → "入站规则" → "新建规则"
3. 选择 "端口" → 下一步
4. 选择 "TCP" → 输入 "特定本地端口"：3000 → 下一步
5. 选择 "允许连接" → 下一步
6. 保持默认设置 → 下一步
7. 输入规则名称（如 "Node.js Server"）→ 完成

### 步骤3：测试服务器可访问性
1. **使用浏览器测试**：访问 `http://lijunpeng.top:3000`
2. **使用命令行测试**：
   ```powershell
   Invoke-WebRequest -Uri 'http://lijunpeng.top:3000' -UseBasicParsing
   ```
3. **使用在线工具测试**：访问 [canyouseeme.org](https://canyouseeme.org/)，输入端口 3000

### 步骤4：验证微信小程序配置
在微信公众平台的小程序设置中，添加 `http://lijunpeng.top` 到合法域名列表。

## 预期结果
完成上述设置后，通过域名 `http://lijunpeng.top:3000` 应该能够正常访问您的服务器，解决 502 错误网关问题。