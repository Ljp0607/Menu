<!-- pages/mine/index.wxml -->
<view class="container">
  <!-- 用户信息 -->
  <view class="user-info">
    <image class="avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
    <view class="user-name">{{userInfo.nickName}}</view>
  </view>

  <!-- 额度信息 -->
  <view class="limit-info">
    <view class="limit-item">
      <text class="limit-label">今日额度</text>
      <text class="limit-value">¥{{dailyLimit}}</text>
    </view>
    <view class="limit-divider"></view>
    <view class="limit-item">
      <text class="limit-label">已使用</text>
      <text class="limit-value used">¥{{usedAmount}}</text>
    </view>
    <view class="limit-divider"></view>
    <view class="limit-item">
      <text class="limit-label">剩余额度</text>
      <text class="limit-value remaining">¥{{remainingLimit}}</text>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="action-buttons">
    <button class="btn-reset" bindtap="resetLimit">重置今日额度</button>
  </view>

  <!-- 历史订单 -->
  <view class="orders-section">
    <view class="section-header">
      <text class="section-title">历史订单</text>
    </view>
    
    <view class="empty-orders" wx:if="{{orders.length === 0}}">
      <text class="empty-text">暂无历史订单</text>
    </view>
    
    <view class="orders-list" wx:else>
      <view class="order-item" wx:for="{{orders}}" wx:key="id">
        <view class="order-header">
          <view class="order-info">
            <text class="order-time">{{item.createTime}}</text>
          </view>
        </view>
        
        <view class="order-goods">
          <view class="goods-item" wx:for="{{item.goods}}" wx:for-item="goods" wx:for-index="goodsIndex" wx:key="id">
            <view class="goods-name">{{goods.name}} x {{goods.count}}</view>
          </view>
        </view>
        
        <view class="order-footer">
          <view class="total-info">
            <text class="total-label">总计：</text>
            <text class="total-price">¥{{item.totalPrice}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>